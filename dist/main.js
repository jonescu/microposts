(()=>{"use strict";const t=new class{async get(t){const e=await fetch(t);return await e.json()}async post(t,e){const n=await fetch(t,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(e)});return await n.json()}async put(t,e){const n=await fetch(t,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(e)});return await n.json()}async delete(t){return await fetch(t,{method:"DELETE",headers:{"Content-type":"application/json"}}),await"Resource Deleted..."}},e=new class{constructor(){this.post=document.querySelector("#posts"),this.titleInput=document.querySelector("#title"),this.bodyInput=document.querySelector("#body"),this.idInput=document.querySelector("#id"),this.postSubmit=document.querySelector(".post-submit"),this.formState="add"}showPosts(t){let e="";t.forEach((t=>{e+=`\n            <div class="card mb-3">\n                <div class="card-body">\n                    <h4 class="card-title">${t.title}</h4>\n                    <p class="card-text">${t.body}</p>\n                    <a href="#" class="edit card-link" data-id="${t.id}">\n                    <i class="fa fa-pencil"></i>\n                    </a>\n                    <a href="#" class="delete card-link" data-id="${t.id}">\n                    <i class="fa fa-remove"></i>\n                    </a>\n                </div>\n            </div>\n            `})),this.post.innerHTML=e}showAlert(t,e){this.clearAlert();const n=document.createElement("div");n.className=e,n.appendChild(document.createTextNode(t));const o=document.querySelector(".postsContainer"),s=document.querySelector("#posts");o.insertBefore(n,s),setTimeout((()=>{this.clearAlert()}),3e3)}clearAlert(){const t=document.querySelector(".alert");t&&t.remove()}clearFields(){this.titleInput.value="",this.bodyInput.value=""}fillForm(t){this.titleInput.value=t.title,this.bodyInput.value=t.body,this.idInput.value=t.id,this.changeFormState("edit")}clearIdInput(){this.idInput.value=""}changeFormState(t){if("edit"===t){this.postSubmit.textContent="Update Post",this.postSubmit.className="post-submit btn btn-warning btn-block mb-2";const t=document.createElement("button");t.className="post-cancel btn btn-light btn-block",t.appendChild(document.createTextNode("Cancel Edit"));const e=document.querySelector(".card-form"),n=document.querySelector(".form-end");e.insertBefore(t,n)}else this.postSubmit.textContent="Post",this.postSubmit.className="post-submit btn btn-primary btn-block mb-2",document.querySelector(".post-cancel")&&document.querySelector(".post-cancel").remove(),this.clearIdInput(),this.clearFields()}};function n(){t.get("http://localhost:3000/posts").then((t=>e.showPosts(t))).catch((t=>console.log(t)))}document.addEventListener("DOMContentLoaded",n),document.querySelector(".post-submit").addEventListener("click",(function(){const o=document.querySelector("#title").value,s=document.querySelector("#body").value,a=document.querySelector("#id").value,c={title:o,body:s};""===o||""===s?e.showAlert("Please fill in all fields","alert alert-danger"):""===a?t.post("http://localhost:3000/posts",c).then((t=>{e.showAlert("Post added","alert alert-success"),e.clearFields(),n()})).catch((t=>console.log(t))):t.put(`http://localhost:3000/posts/${a}`,c).then((t=>{e.showAlert("Post updated","alert alert-success"),e.changeFormState("add"),n()})).catch((t=>console.log(t)))})),document.querySelector("#posts").addEventListener("click",(function(o){if(o.target.parentElement.classList.contains("delete")){const s=o.target.parentElement.dataset.id;confirm("Are you sure?")&&t.delete(`http://localhost:3000/posts/${s}`).then((t=>{e.showAlert("Post removed","alert alert-success"),n()})).catch((t=>console.log(t)))}o.preventDefault()})),document.querySelector("#posts").addEventListener("click",(function(t){if(t.target.parentElement.classList.contains("edit")){const n={id:t.target.parentElement.dataset.id,title:t.target.parentElement.previousElementSibling.previousElementSibling.textContent,body:t.target.parentElement.previousElementSibling.textContent};e.fillForm(n)}t.preventDefault()})),document.querySelector(".card-form").addEventListener("click",(function(t){t.target.classList.contains("post-cancel")&&e.changeFormState("add"),t.preventDefault()}))})();